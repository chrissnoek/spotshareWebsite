{"version":3,"sources":["webpack:///./src/components/Results/Results.jsx"],"names":["Results","props","locations","setLocations","useState","filteredLocations","setFilteredLocations","activeFilter","setActiveFilter","selectedLocation","setSelectedLocation","showMap","setShowMap","history","useHistory","location","useLocation","useEffect","getLocations","_activeFilter","getActiveFilter","_filteredLocations","filter","include","location_categories","categorie","id","length","_locations","store","initialData","console","log","fetchData","search","photos","params","URLSearchParams","get","useConstructor","onFilterChange","e","reset","vars","lat","lng","url","target","value","push","selectLocation","locationId","map","match","showError","findNearbyLocations"],"mappings":"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","file":"server.8122a18c20c1ab97db88.hot-update.js","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport { findNearbyLocations } from \"../FindNearbyLocations.jsx\";\n/* to support IE */\nimport store from \"../../store.js\";\nimport useConstructor from \"../ConstructorHook.jsx\";\nimport ResultMap from \"./ResultMap.jsx\";\nimport CategorieFilter from \"./CategorieFilter.jsx\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport LocationList from \"./LocationList.jsx\";\n\nconst Results = (props) => {\n  const [locations, setLocations] = useState();\n  const [filteredLocations, setFilteredLocations] = useState({});\n  const [activeFilter, setActiveFilter] = useState(\"\");\n  const [selectedLocation, setSelectedLocation] = useState();\n  const [showMap, setShowMap] = useState(false);\n\n  let history = useHistory();\n  let location = useLocation();\n\n  useEffect(() => {\n    !locations && getLocations();\n\n    const _activeFilter = getActiveFilter();\n\n    if (locations) {\n      const _filteredLocations = locations.filter((location) => {\n        const include = location.location_categories.filter((categorie) => {\n          if (categorie.id === _activeFilter) {\n            return true;\n          } else {\n            return false;\n          }\n        });\n        //console.log(location.id, include);\n        if (include.length > 0) return true;\n      });\n      setFilteredLocations(_filteredLocations);\n    }\n    //console.log(_filteredLocations);\n  }, [location]);\n\n  const getLocations = async () => {\n    let _locations = store.initialData ? store.initialData : null;\n    console.log(store.initialData, _locations);\n    delete store.initialData;\n    if (!_locations) {\n      console.log(\"getting locations\");\n      _locations = await Results.fetchData(null, location.search);\n    }\n    setLocations(_locations.filter((location) => location.photos.length > 0));\n    console.log(_locations);\n  };\n\n  const getActiveFilter = () => {\n    const params = new URLSearchParams(location.search);\n\n    const _activeFilter = params.get(\"categorie\")\n      ? params.get(\"categorie\")\n      : \"\";\n\n    if (_activeFilter) {\n      return _activeFilter;\n    } else {\n      return false;\n    }\n  };\n\n  useConstructor(() => {\n    const _activeFilter = getActiveFilter();\n    if (_activeFilter) {\n      setActiveFilter(_activeFilter);\n    }\n    getLocations();\n    setShowMap(true);\n  });\n\n  const onFilterChange = (e, reset) => {\n    const params = new URLSearchParams(location.search);\n\n    const vars = {};\n    if (params.get(\"lat\")) vars.lat = params.get(\"lat\");\n    if (params.get(\"lng\")) vars.lng = params.get(\"lng\");\n\n    let url = \"\";\n    if (reset) {\n      url = `/fotolocaties/resultaten?lng=${vars.lng}&lat=${vars.lat}`;\n    } else {\n      url = `/fotolocaties/resultaten?lng=${vars.lng}&lat=${vars.lat}&categorie=${e.target.value}`;\n    }\n\n    history.push(url);\n  };\n\n  const selectLocation = (locationId) => {\n    setSelectedLocation(locationId);\n  };\n\n  return (\n    <div className=\"relative h-screen\">\n      <div className=\"flex h-full\">\n        <div className=\"w-full p-4 h-screen overflow-scroll\">\n          <h1>Resultaten</h1>\n          <div className=\"mb-2 flex\">\n            <span className=\"mr-2\">Filter op categorie:</span>\n            {locations &&\n              (filteredLocations.length > 0 ? (\n                <CategorieFilter\n                  active={activeFilter}\n                  onFilterChange={onFilterChange}\n                  categories={filteredLocations.map((location) => {\n                    return location.location_categories;\n                  })}\n                />\n              ) : (\n                <CategorieFilter\n                  active={activeFilter}\n                  onFilterChange={onFilterChange}\n                  categories={locations.map((location) => {\n                    return location.location_categories;\n                  })}\n                />\n              ))}\n          </div>\n          {locations &&\n            (filteredLocations.length > 0\n              ? filteredLocations.map((location) => (\n                  <div key={location.id} className=\"w-full\">\n                    <LocationList\n                      size=\"large\"\n                      location={location}\n                      key={location.id}\n                      active={selectedLocation === location.id ? true : false}\n                      selectLocation={selectLocation}\n                    />\n                  </div>\n                ))\n              : locations.map((location) => (\n                  <div key={location.id} className=\"w-full\">\n                    <LocationList\n                      size=\"large\"\n                      location={location}\n                      key={location.id}\n                      active={selectedLocation === location.id ? true : false}\n                      selectLocation={selectLocation}\n                    />\n                  </div>\n                )))}\n        </div>\n\n        <div className=\"mb-10 w-full h-full\">\n          {showMap &&\n            locations &&\n            (filteredLocations.length > 0 ? (\n              <ResultMap\n                locations={filteredLocations}\n                selectLocation={selectLocation}\n                active={selectedLocation}\n              />\n            ) : (\n              <ResultMap\n                locations={locations}\n                selectLocation={selectLocation}\n                active={selectedLocation}\n              />\n            ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Results;\n\nResults.fetchData = async (match, search, showError) => {\n  // test URL; http://localhost:8000/fotolocaties/resultaten?lng=52.379189&lat=4.899431\n  // use URLSearchParams for IE Compatibility\n  const params = new URLSearchParams(search);\n\n  console.log(\"fetching data\");\n\n  const vars = {};\n  if (params.get(\"lat\")) vars.lat = params.get(\"lat\");\n  if (params.get(\"lng\")) vars.lng = params.get(\"lng\");\n  //vars.cat = params.get(\"categorie\") ? params.get(\"categorie\") : \"\";\n\n  console.log(vars);\n\n  const _locations = await findNearbyLocations(vars.lat, vars.lng);\n\n  console.log(_locations);\n\n  return _locations;\n};\n"],"sourceRoot":""}